MAPE(mlp.model$fitted,train_data)
detach("package:MLmetrics", unload = TRUE)
install.packages("TSrepr")
library(TSRepr)
library(TSRepr)
library(TSrepr)
library(TSrepr)
mape(train_data,mlp.model$fitted)
length(train_data)
length(mlp.model$fitted)
296-272
mlp.model
summary(mlp.model)
View(mlp.model)
mlp.model[["lags"]]
mlp.model<-mlp(as.ts(train_data),hd=c(5,7,8,3))
mlp.model<-mlp(as.ts(train_data),hd=c(5,7,8,3))
mlp.model
length(train_data)
length(mlp.model$fitted)
mlp.model$fitted
View(mlp.model)
mlp.model$fitted[1:23]
mlp.model$fitted['2017']
as.xts(mlp.model$fitted)
mlp.model$fitted
arima.model$fitted
start(mlp.model$fitted)
mlp.model$fitted
start_point<-start(mlp.model$fitted)
window(train_data,start = start_point)
train_data
train_data
mlp.model$fitted
train_data
mlp.model$fitted
train_data
mlp.model$fitted
View(mlp.model)
as.ts(mlp.model$fitted)
train_data
mlp.model$fitted
as.xts(mlp.model$fitted)
View(train_data)
ts(mlp.model$fitted,start = c(1996,1))
train_data
ts(mlp.model$fitted,start = c(1996,1)) %>% as.xts()
ts(mlp.model$fitted,start = c(1996,1))
ts(mlp.model$fitted,start = c(1996,1)) %>% as.xts()
ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts()
length(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts()_
length(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
length(train_data)
(train_data)
(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
(ts(mlp.model$fitted,start = c(1995,1),frequency = 12) %>% as.xts())
(ts(mlp.model$fitted,start = c(1991,1),frequency = 12) %>% as.xts())
(train_data)
(ts(mlp.model$fitted,start = c(1993,1),frequency = 12) %>% as.xts())
(train_data)
(ts(mlp.model$fitted,start = c(1995,1),frequency = 12) %>% as.xts())
(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
(train_data)-(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
(train_data)
(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
(train_data)
(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts()
train_data['1996/']
length(train_data['1996/'])
length(ts(mlp.model$fitted,start = c(1996,1),frequency = 12) %>% as.xts())
length(ts(mlp.model$fitted,start = c(1996,5),frequency = 12) %>% as.xts())
View(test_data)
View(train_data)
length(ts(mlp.model$fitted,start = c(1996,5),frequency = 12) %>% as.xts())
length(train_data['1996/'])
train_data['1996/']
mlp.model$fitted-train_data
mlp.model.fitted
mlp.model.fitted<-as.xts(mlp.model$fitted)
mlp.model.fitted
length(mlp.model.fitted)
length(train_data['1996/'])
View(train_data)
mlp.model$fitted
ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_data<-flow_data_xts['1994/2018']
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
my_function<- function(x){
x*2
}
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
}
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_data<-flow_data_xts['1994/2018']
test_data<-flow_data_xts['2019']
train_data<-window(flow_data_xts,1994,2018)
test_data<-window(flow_data_xts,2019)
arima.model<-auto.arima(train_data)
arima.model2<-auto.arima(train_data,lambda = "auto")
mlp.model<-mlp(as.ts(train_data),hd=c(5,7,8,3))
length(mlp.model$fitted)
length(train_data)
train_data
length(mlp.model$fitted)
length(train_data)
285-272
mlp.model
ts.intersect(train_data,mlp.model$fitted)
train_data
train_data<-window(flow_data_xts,1994,2018)
train_data<-window(flow_data_xts,1994,2018)
train_data
train_data<-window(flow_data_xts,1994,c(3,2018))
train_data<-window(flow_data_xts,1994,c(2017,12))
train_data
train_data<-window(flow_data_xts,1994,c(2018,12))
train_data
test_data<-window(flow_data_xts,2019)
arima.model<-auto.arima(train_data)
arima.model2<-auto.arima(train_data,lambda = "auto")
mlp.model<-mlp(as.ts(train_data),hd=c(5,7,8,3))
length(mlp.model$fitted)
length(train_data)
ts.intersect(train_data,mlp.model$fitted)
result<-ts.intersect(train_data,mlp.model$fitted)
View(result)
colnames(result)<-c("train_data","mlp_fitted")
result
remove.packages("MLmetrics", lib="~/tesis/packrat/lib/x86_64-w64-mingw32/3.6.1")
result$train_data
result[[train_data]]
result[train_data]
result[1]
result[,1]
result
mape(result[,1],result[,2])
result<-ts.intersect(train_data,mlp.model$fitted,arima.model$fitted)
result
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mean(result[,2:3])
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
snapshot()
install.packages("TSstudio")
library(TSstudio)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
View(train_test_data)
arima.model<-auto.arima(train_test_data$train)
arima.model2<-auto.arima(train_test_data$train,lambda = "auto")
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3))
remove(train_data)
remove(test_data)
snapshot()
train_test_data$train
View(train_test_data)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0, #2018
)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
arima.model2
arima.model
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3),xreg = EIDULFITR)
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3),xreg = EIDULFITR)
View(train_test_data)
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3),xreg = EIDULFITR)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = EIDULFITR)
length(train_test_data$train)
length(EIDULFITR)
arima.model<-auto.arima(train_test_data$train)
arima.model
arima.model2<-auto.arima(train_test_data$train,lambda = "auto")
arima.model2
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
arima.model2
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = EIDULFITR)
length(train_test_data$train)
length(EIDULFITR)
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
#train_data<-window(flow_data_xts,1994,c(2018,12))
#test_data<-window(flow_data_xts,2019)
arima.model<-auto.arima(train_test_data$train)
arima.model2<-auto.arima(train_test_data$train,lambda = "auto")
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3))
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
View(result)
mape(result[,1],(0.5*result[,2]))
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = EIDULFITR)
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
z <- 1:(length(AirPassengers)+24)
z
library(nnfor)
fit1 <- mlp(AirPassengers)
print(fit1)
AirPassengers
z <- 1:(length(AirPassengers)+24)
View(fit1)
z <- cbind(z)
View(z)
fit4 <- mlp(AirPassengers,xreg=z,xreg.lags=list(0),xreg.keep=list(TRUE),
# Add a lag0 regressor and force it to stay in the model
difforder=0)
z <- 1:(length(AirPassengers)+24)
z <- cbind(z)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = cbind(EIDULFITR))
mlp.model
mlp.model<-mlp(as.ts(train_test_data$train),hd=c(5,7,8,3))
mlp.model
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = cbind(EIDULFITR))
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
result<-ts.intersect(train_data,mlp.model$fitted,arima.model2$fitted)
result<-ts.intersect(train_test_data$train,mlp.model$fitted,arima.model2$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],(0.5*result[,2]+0.5*result[,3]))
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
arima.model<-auto.arima(train_test_data$train,xreg =EIDULFITR )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =EIDULFITR)
result<-ts.intersect(train_test_data$train,arima.model2$fitted)
colnames(result)<-c("train_data","arima_fitted")
mape(result[,1],result[,2])
library(xts)
library(forecast)
library(nnfor)
library(TSrepr)
library(TSstudio)
flow_data<-read_data("Jakarta","K50000")
flow_data_xts <- ts(flow_data[,3],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=6)
EIDULFITR<-c(
0,0,0,0,0,0,0,0, #1994
0,0,1,0,0,0,0,0,0,0,0,0, #1995
0,1,0,0,0,0,0,0,0,0,0,0, #1996
0,1,0,0,0,0,0,0,0,0,0,0, #1997
1,0,0,0,0,0,0,0,0,0,0,0, #1998
1,0,0,0,0,0,0,0,0,0,0,0, #1999
1,0,0,0,0,0,0,0,0,0,0,0, #2000
0,0,0,0,0,0,0,0,0,0,0,1, #2001
0,0,0,0,0,0,0,0,0,0,0,1, #2002
0,0,0,0,0,0,0,0,0,0,1,0, #2003
0,0,0,0,0,0,0,0,0,0,1,0, #2004
0,0,0,0,0,0,0,0,0,0,1,0, #2005
0,0,0,0,0,0,0,0,0,1,0,0, #2006
0,0,0,0,0,0,0,0,0,1,0,0, #2007
0,0,0,0,0,0,0,0,0,1,0,0, #2008
0,0,0,0,0,0,0,0,1,0,0,0, #2009
0,0,0,0,0,0,0,0,1,0,0,0, #2010
0,0,0,0,0,0,0,1,0,0,0,0, #2011
0,0,0,0,0,0,0,1,0,0,0,0, #2012
0,0,0,0,0,0,0,1,0,0,0,0, #2013
0,0,0,0,0,0,1,0,0,0,0,0, #2014
0,0,0,0,0,0,1,0,0,0,0,0, #2015
0,0,0,0,0,0,1,0,0,0,0,0, #2016
0,0,0,0,0,1,0,0,0,0,0,0, #2017
0,0,0,0,0,1,0,0,0,0,0,0 #2018
)
mlp.model<-mlp(train_test_data$train,hd=c(5,7,8,3),xreg = cbind(EIDULFITR))
result<-ts.intersect(train_test_data$train,mlp.model$fitted)
colnames(result)<-c("train_data","mlp_fitted","arima_fitted")
mape(result[,1],0.5*result[,2])

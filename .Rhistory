index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
data_outflow<-data_outflow %>% left_join(holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
#data_outflow<-data_outflow %>% left_join(holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
data_outflow<-data_outflow %>% left_join(holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
data_outflow<-left_join(data_outflow,holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
#holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
#data_outflow<-left_join(data_outflow,holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
flow_data<-flow_data %>% left_join(holidays) %>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
flow_data %>% left_join(holidays)
holidays<-generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
flow_data<-flow_data %>% left_join(holidays)
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
data_outflow<-left_join(data_outflow,holidays)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
eidulfitr_regressor<-function(country,holiday){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country==country & holiday==holiday)
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
data_outflow<-left_join(data_outflow,holidays,copy=TRUE)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
#holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
#data_outflow<-left_join(data_outflow,holidays,copy=TRUE)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
eidulfitr_regressor<-function(data,country,holiday){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country==country & holiday==holiday)
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
}
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
#holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
#data_outflow<-left_join(data_outflow,holidays,copy=TRUE)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
flow_data<-flow_data %>% left_join(holidays,copy = TRUE) %>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
eidulfitr_regressor<-function(data,country,holiday){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country==country & holiday==holiday)
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data %>% left_join(holidays,copy = TRUE) %>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
eidulfitr_regressor(flow_data,country = ="ID",holidays="Eid al-Fitr")
eidulfitr_regressor(data=flow_data,country ="ID",holidays="Eid al-Fitr")
eidulfitr_regressor(data=flow_data,country ="ID",holiday="Eid al-Fitr")
eidulfitr_regressor<-function(data,country,holiday){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country==country & holiday==holiday)
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
#%>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
read_data<-function(kota,pecahan){
library(gsheet)
library(tidyverse)
url<-"https://docs.google.com/spreadsheets/d/1pYpYd04zw6iUz32mGkGNz_1_-jorwM-QWGxXSKiOzpo/edit?usp=sharing"
a <- gsheet2text(url, format='csv')
b <- read.csv(text=a, stringsAsFactors=FALSE)
c<-b %>% filter(Kota == kota)
Dataset_Surabaya <- c
data_outflow<-data.frame(tahun=Dataset_Surabaya[["Tahun"]],
bulan=Dataset_Surabaya[["Bulan"]],
data1=Dataset_Surabaya[pecahan]
)
index<-data_outflow[pecahan]==0
data_outflow[pecahan][index]<-NA
data_outflow<-na.omit(na.approx(data_outflow))
data_outflow<-as.data.frame(data_outflow)
#holidays<-eidulfitr_regressor(country = "ID",holiday = "Eid al-Fitr")
#data_outflow<-left_join(data_outflow,holidays,copy=TRUE)
#data_outflow<-data_outflow %>% select(tahun:ds)
#data_outflow<-data_outflow %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
flow_data<-read_data("Jakarta","K50000")
eidulfitr_regressor(data=flow_data,country ="ID",holiday="Eid al-Fitr")
View(flow_data)
add_eidulfitr_regressor<-function(data,country,holiday){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country==country & holiday==holiday)
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
#%>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
#%>% select(tahun:ds) %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
}
add_eidulfitr_regressor(data=flow_data)
fff<-add_eidulfitr_regressor(data=flow_data)
View(fff)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
View(fff)
columns(data$ds)<-"eidulfitr"
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
columns(data$ds)<-"eidulfitr"
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
column(data$ds)<-"eidulfitr"
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
colnames(data$ds)<-"eidulfitr"
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
data<-data %>% rename(ds=eid)
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
data<-data %>% rename(ds="eid")
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000")
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000")
fff<-add_eidulfitr_regressor(data=flow_data)
View(fff)
colnames(ds)<-"eid"
fff<-add_eidulfitr_regressor(data=flow_data)
colnames(fff$ds)<-"eid"
colnames(fff)[4]<-"eid"
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
data<-colnames(data)[4]<-"eid"
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000")
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
colnames(data)[colnames(data) == 'ds'] <- 'eid'
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
fff<-add_eidulfitr_regressor(data=flow_data)
flow_data<-read_data("Jakarta","K50000")
fff<-add_eidulfitr_regressor(data=flow_data)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
#colnames(data)[colnames(data) == 'ds'] <- 'eid'
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000")
flow_data<-add_eidulfitr_regressor(data=flow_data)
View(flow_data)
read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
flow_data<-read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
summary(flow_data)
flow_data
flow_data_xts <- ts(flow_data[,3:4],
start=c(flow_data[1,1], flow_data[1,2]),
end=c(2019, 6),frequency = 12)
flow_data_xts
holidays<-generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
holidays
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
add_1994<-data.frame("1994-03-14","Eid al-Fitr","ID",1994,3,1994)
names(add_1994)<-c("ds","holiday","country","year","bulan","tahun")
add_1994<-rbind(holidays, add_1994)
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
#colnames(data)[colnames(data) == 'ds'] <- 'eid'
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
flow_data
library(prophet)
get_holiday_names()
holidays<-generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
add_1994<-data.frame("1994-03-14","Eid al-Fitr","ID",1994,3,1994)
names(add_1994)<-c("ds","holiday","country","year","bulan","tahun")
add_1994
holidays
View(holidays)
add_eidulfitr_regressor<-function(data){
holidays<-prophet::generated_holidays
holidays<-holidays %>% filter(country=="ID" & holiday=="Eid al-Fitr")
holidays$bulan<-as.integer(format(as.Date(holidays$ds), "%m"))
holidays$tahun<-as.integer(format(as.Date(holidays$ds), "%Y"))
add_1994<-data.frame("1994-03-14","Eid al-Fitr","ID",1994,3,1994)
names(add_1994)<-c("ds","holiday","country","year","bulan","tahun")
holidays<-rbind(holidays, add_1994)
data<-data %>% left_join(holidays,copy = TRUE)
data<-data %>% select(tahun:ds)
data<-data %>% mutate(ds=ifelse(is.na(ds),yes = 0,no=1))
#colnames(data)[colnames(data) == 'ds'] <- 'eid'
#data<-as_tibble(data) %>% rename(ds=eid)
#%>%  %>%
}
flow_data<-read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
flow_data
flow_data_xts <- ts(flow_data[,3:4],
start=c(flow_data[1,1], flow_data[1,2]),
end=c(2019, 6),frequency = 12)
flow_data_xts
init_run()
set.seed(72)
flow_data<-read_data("Jakarta","K50000") %>% add_eidulfitr_regressor()
flow_data_xts <- ts(flow_data[,3:4],start=c(flow_data[1,1], flow_data[1,2]), end=c(2019, 6),
frequency=12)
train_test_data<-ts_split(flow_data_xts,sample.out=12)
train_test_data$train
train_test_data$train[,1]
arima.model<-auto.arima(train_test_data$train[,1],xreg =train_test_data$train[,2] )
arima.model
arima.model<-auto.arima(train_test_data$train[,1],xreg =train_test_data$train[,2] )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =train_test_data$train[,2])
arima.model<-auto.arima(train_test_data$train[,1],xreg =train_test_data$train[,2] )
arima.model
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",
xreg =train_test_data$train[,2])
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =train_test_data$train[,2])
train_test_data
arima.model<-auto.arima(train_test_data$train[,1],xreg =train_test_data$train[,2] )
arima.model2<-auto.arima(train_test_data$train,lambda = "auto",xreg =train_test_data$train[,2])
train_test_data$train[,2]
arima.model2<-auto.arima(train_test_data$train,lambda = 0.3,xreg =train_test_data$train[,2])
arima.model2<-auto.arima(train_test_data$train,xreg =train_test_data$train[,2],lambda = "auto")
arima.model2<-auto.arima(train_test_data$train[,1],xreg =train_test_data$train[,2],lambda = "auto")
arima.model2
arima.model
result<-ts.intersect(train_test_data$train,arima.model2$fitted)
colnames(result)<-c("train_data","arima_fitted")
result<-ts.intersect(train_test_data$train,arima.model2$fitted)
colnames(result)<-c("train_data","arima_fitted")
View(result)
result<-ts.intersect(train_test_data[,1]$train,arima.model2$fitted)
result<-ts.intersect(train_test_data$train[,1],arima.model2$fitted)
colnames(result)<-c("train_data","arima_fitted")
mape(result[,1],result[,2])
